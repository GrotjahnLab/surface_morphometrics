# UNIVERSAL
data_dir: "./thickness_examples/segmentations/"  # Directory containing segmentation MRC files
tomo_dir: "./thickness_examples/tomograms/"  # Directory containing tomogram MRC files (for thickness measurements)
work_dir: "./thickness_examples/morphometrics/"  # Working directory for output files
exp_name: "test" # Subdirectory of work folder for this experiment
segmentation_values: # The value used to represent each feature, and the name of the feature.
  OMM: 1
  IMM: 2
  ER: 3
cores: 6 # Number of cores to use for parallel processing.

#SEGMENTATION TO MESH 
surface_generation:
  angstroms: false # Default scaling adjusts so surfaces are nm-scaled, if set to true surfaces are not rescaled and remain angstrom-scaled.
  ultrafine: false # Not necessary under normal conditions but may help with unusually challenging membranes. Uses additional subdivision and resampling before cropping.
  extrapolation_distance: 1.5 # Distance in nm (or angstroms, if angstrom setting is True) to extrapolate the surface
  isotropic_remesh: false # If true, applies isotropic remeshing to create near-equilateral triangles with target average area.
  target_area: 1.0 # Target average triangle area in square units (nm^2 by default). Used when isotropic_remesh is true. Values between 1.0 and 3.0 generally yield good results, but smaller triangles significantly increase computation time.
  simplify: true # If true, decimates the mesh to max_triangles. Note: simplified surfaces will not be isotropic.
  max_triangles: 100000 # Only used if simplify is true. When using isotropic_remesh, target_area controls triangle count instead.
  octree_depth: 9 # Increase if the surface is too smooth, decrease if surface is too jagged - but has a HUGE effect.
  point_weight: 0.7 # Larger numbers have stronger weight towards fitting segmented points, smaller numbers have stronger weight towards generating a smooth surface
  neighbor_count: 400 # Number of neighbors used for normal estimation. Should not need to adjust this, but I am exposing it as a tuning variable. Values over 50 seem to all be equivalently good...
  smoothing_iterations: 1 # Number of smoothing iterations to perform for estimating normals. You should usually leave this at 1.

# PYCURV
curvature_measurements:
  radius_hit: 9 # This corresponds to the radius of the smallest feature of interest, roughly, for neighborhood determination. 8-15 seems to be a good range for mitochondria
  min_component: 30 # The minimum number of triangles for a component to be considered for curvature measurement.
  exclude_borders: 1 # Values greater than zero exclude the border from the curvature calculation by n nm/angstroms.
distance_and_orientation_measurements:
  mindist: 3 # Minimum distance between two points for them to be considered for distance measurement.
  maxdist: 400 # Maximum distance between two points for them to be considered for distance measurement.
  tolerance: 0.1 # Tolerance for determining if a triangle is contacted by a line.
  verticality: true # Measure verticality (angle relative to growth plane). 
  intra: # Intra-surface distance/orientation (verticality) measurements
    - OMM
    - IMM
    - ER
  relative_orientation: true # Measure relative orientation (angle relative to nearest neighbor surface).
  inter: # Intersurface distance/orientation measurements. Writes out symmetrically so you do not need to give symmetric options.
    OMM:
      - IMM
      - ER
 
# DENSITY SAMPLING (used by sample_density.py)
density_sampling:
  sample_spacing: 0.25  # Distance in nm between samples along normal vectors. Should divide evenly into scan_range.
  scan_range: 10  # Half-range in nm to scan along normal vectors (scans from -scan_range to +scan_range)

# THICKNESS MEASUREMENTS (used by measure_thickness.py)
thickness_measurements:
  average_radius: 12  # Radius in nm for local averaging in thickness calculations
  fit_curve: true  # Fit dual gaussian to estimate thickness
  components:  # Components to process for thickness measurements
    - OMM
    - IMM
    - ER

# MESH REFINEMENT (used by refine_mesh.py)
mesh_refinement:
  iterations: 5  # Number of refinement iterations
  damping_factor: 0.6  # Fraction of impulse to apply (0-1). Values 0.5-0.7 work well to prevent oscillation.
  monolayer: false  # Set to true for high-defocus data where bilayer is not resolved. Fits single Gaussian instead of dual.
  average_radius: 12  # Radius in nm for local averaging of density profiles. Larger values = more smoothing.
  average_radius_decay: 1.0  # Factor to multiply radius by each iteration (e.g., 0.8 = 20% reduction). Set to 1.0 for no decay.
  average_radius_min: 3.0  # Minimum averaging radius in nm (prevents over-fitting to noise in later iterations).





